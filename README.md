# Web-ларёк

Интернет-магазин с товарами для веб-разработчиков.
В приложении можно:

- Просматривать каталог
- Просматривать товар
- Добавлять в корзину / удалять из корзины
- Оформлять заказ

## Описание

В проекте применен принцип MVP (Model-View-Presenter), который обеспечивает четкое разделение ответственностей между классами Model и View каждый класс выполняет свою определенную роль:

Model - содержит всю бизес-логику

View - реализует интерфейс приложение

EventEmitter выступает в роли Представителя (Presenter) - связывает модели данных с отображением интерфейсов через события

### Стек технологий:

    HTML, SCSS, TS, Webpack

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

### Структура проекта:

- src/ — исходные файлы проекта
- src/components/base/ — базовые классы
- src/components/api/ — классы для работы с api
- src/components/Model/ — модели
- src/components/View/ — все view
- src/types/ — основная типизация проекта
- src/utils/ — функции, решающие разную мелочь

## Описание базовых классов

### Класс `Api`

Методы:

- `get(uri: string)` - принимает изменяющеюся часть url-адреса, возвращает ответ от сервера
- `post(uri: string, data: object, method: ApiPostMethods = 'POST')` - принимает изменяющеюся часть url-адреса, принимает данные в виде объекта для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

Используется для создания API-классов

### Класс `EventEmitter`

Класс EventEmitter реализует паттерн «Observer/Наблюдатель» и обеспечивает работу событий, его методы позволяют устанавливать и снимать слушатели событий, вызвать слушатели при возникновении события.

Методы:

- `on` - для подписки на событие.
- `off` - для отписки от события.
- `emit` - уведомления подписчиков о наступлении события соответственно.
- `onAll` - для подписки на все события.
- `offAll` - сброса всех подписчиков.
- `trigger` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса `EventEmitter`.

### Класс `BaseModel`

Класс BaseModel исользуется для создания всех основных моделей

### Класс `BaseView`

BaseView является абстрактным классом, от которого наследуются все view

Методы:

- `render(data?: unknown)` - изменяет HTML элемент и возвращает его. Все потомки обязаны реализовать этот метод
- `destroy()` - удаляет view
- `getElement()` - возвращает view (HTMLElement) с которым мы работаем

## API

### Класс `OrderApi`

API по работе с заказами
Используется в модели Checkout

Методы:

- `createOrder(data: createOrderParams)` - создаёт заказ на сервере

### Класс `ProductApi`

API по работе с продуктами

Методы:

- `getProducts()` - получить все продукты с сервера
- `getProduct(id: string)` - получить продукт по id

## Модели

### `ProductsModel`

Модель для работы с продуктами. Нужно передать api, с которым модель будет взаимодействовать

Методы:

- `fetchProducts()` - Получаем продукты с сервера

Разово получает продукты при инициализации

### `CartModel`

Модель для работы с корзиной

Методы:

- `addToCart(item: CartItem)` - Добавление товара в корзину
- `removeFromCart(itemId: string)` - Удаление товара из корзины
- `viewCart()` - Просмотр корзины
- `checkout()` - Начать оформление чекаута
- `getCartItems()` - Получить товары из корзины

Реагирует и вызывает события связанные с корзиной. Также вызывает событие о начале checkout, которое перехватывает CheckoutModel

### `ChekoutModel`

Модель для работы с оформлением заказа

Методы:

- `createOrder()` - проверяет и в случае успеха отправляет данные на сервер

## View

### `Cart`

View для отображения корзины

Методы:

- `render(data: : {cartItemsViews: HTMLElement[]; total: number})` - принимает массив HTMLElement - cartitems, а также total - суммарную стоимость заказа

### `CartItemLine`

View для отображения товара внутри корзины

Методы:

- `render(data: { cartItem: CartItem; index: number })` - принимает cartitem - информацию о товаре, а также index - порядковый номер в корзину

### `CheckoutContacts`

View для отображения формы оформления заказа контактов

Методы:

- `render()` - просто даёт HTMLElement
- `validate()` - валидация формы и паралельное разблокирование кнопки

### `CheckoutOrder`

View для отображения формы оформления заказа первого шага

Методы:

- `render()` - просто даёт HTMLElement
- `validate()` - валидация формы и паралельное разблокирование кнопки

### `CheckoutSuccess`

View успешного оформления заказа

Методы:

- `render(total: number)` - принимает total - суммарную стоимость заказа

### `Modal`

View модального окна

Методы:

- `render(value: HTMLElement)` - заменяет своё содержимое этим элементом
- `open()` - показывает модальное окно и блокирует прокрутку страницы
- `close()` - скрывает модальное окно и снимает блокировку страницы

### `ProductCard`

View карточки товара для каталога

Методы:

- `render(data: Product)` - подставляет нужные данные продукта

### `ProductModal`

View карточки товара внутри модального окна, наследуется от ProductCard

Методы:

- `render(data: Product)` - подставляет нужные данные продукта
- `updateButtonClickHandler(handler: () => void) ` - Смена обработчика клика на кнопку
